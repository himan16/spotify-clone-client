{"version":3,"sources":["Login.js","useAuth.js","TrackSearchResult.js","Player.js","Dashboard.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","useAuth","code","useState","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","useEffect","axios","post","then","res","console","log","data","window","history","pushState","catch","err","location","timeInterval","setInterval","clearInterval","TrackSearchResult","props","cursor","onClick","chooseTrack","track","src","albumUrl","height","width","alt","marginLeft","title","artist","Player","play","setPlay","trackUri","token","showSaveIcon","callback","state","isPlaying","uris","spotifyApi","SpotifyWebApi","clientId","Dashboard","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","get","params","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ad306dbe.chunk.js","sourcesContent":["import React from \"react\";\nimport {Container} from \"react-bootstrap\";\n// const clientId = \"9520eccbac5849a1bd5c98af590bfc0d\";\n\nconst AUTH_URL = \"https://accounts.spotify.com/authorize?client_id=9520eccbac5849a1bd5c98af590bfc0d&response_type=code&redirect_uri=http://localhost:3000/&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\";\n\nfunction Login(){\n    return(\n        <Container \n        className=\"d-flex justify-content-center align-items-center\"\n        style={{minHeight: \"100vh\"}}\n        >\n            <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>Login with Spotify</a>\n        </Container>\n    )\n}\n\nexport default Login; ","\nimport  {useState, useEffect} from \"react\";\nimport axios from \"axios\";\n\nfunction useAuth(code){\n const [accessToken, setAccessToken] = useState();\n const [refreshToken, setRefreshToken] = useState();\n const [expiresIn, setExpiresIn] = useState();\n  \n useEffect(()=>{\n   axios\n    .post(\"https://myspotify-server.herokuapp.com/login\", {code})\n    .then(res=>{\n        console.log(\"res.data ->\",res.data)\n        setAccessToken(res.data.accessToken)\n        setRefreshToken(res.data.refreshToken)\n        setExpiresIn(res.data.expiresIn)\n        window.history.pushState({}, null, \"/\")\n    })\n    .catch((err)=>{\n        console.log(\"errbc = \", err);\n        window.location=\"/\"\n    })\n }, [code])\n\n useEffect(()=>{\n     if(!refreshToken || !expiresIn) return\n     const timeInterval = setInterval(()=>{\n        axios\n        .post(\"https://myspotify-server.herokuapp.com/refresh\", {refreshToken})\n        .then(res=>{\n            setAccessToken(res.data.accessToken)\n            setExpiresIn(res.data.expiresIn)\n            })\n        .catch((err)=>{\n            console.log(\"err = \", err);\n            window.location=\"/\"\n            })\n     }, (expiresIn-60)*1000)\n     return ()=>clearInterval(timeInterval)\n }, [refreshToken, expiresIn])\n\n return accessToken;\n}\n\nexport default useAuth;","import React from \"react\"\n\n\nfunction TrackSearchResult(props){\n    \n    function handlePlay(){\n       props.chooseTrack(props.track)\n    }\n\n    return( \n        <div \n        className=\"d-flex m-2 align-items-center\"\n        style={{cursor: \"pointer\"}}\n        onClick={handlePlay}\n        >\n            <img src={props.track.albumUrl} style={{height: \"64px\", width: \"64px\"}} alt=\"track img\"/>\n            <div className=\"ml-3\" style={{marginLeft: \"1%\"}}>\n                <div>{props.track.title}</div>\n                <div className=\"text-muted\">{props.track.artist}</div>\n            </div>\n        </div>\n    )\n}\n\nexport default TrackSearchResult","import React, {useEffect, useState} from \"react\"\n\nimport SpotifyPlayer from \"react-spotify-web-playback\"\n\nfunction Player(props){\n    \n    // console.log(props.trackUri)\n    const [play, setPlay] = useState(false)\n\n    useEffect(()=>{\n       setPlay(true)\n    }, [props.trackUri])\n         \n    if (!props.accessToken) return null\n    \n    return (\n        <SpotifyPlayer\n            token={props.accessToken}\n            showSaveIcon\n            callback={state=>{\n                if(!state.isPlaying) setPlay(false)\n            }}\n            play={play}\n            uris={ props.trackUri ? [props.trackUri]:[]}\n        />\n    )\n}\n\nexport default Player","import React, {useState, useEffect} from \"react\";\nimport useAuth from \"./useAuth.js\";\nimport {Container, Form} from \"react-bootstrap\"\nimport SpotifyWebApi from \"spotify-web-api-node\" \nimport TrackSearchResult from \"./TrackSearchResult.js\"\nimport Player from \"./Player.js\"\nimport axios from \"axios\";\nconst spotifyApi = new SpotifyWebApi({\n    clientId: \"9520eccbac5849a1bd5c98af590bfc0d\"\n})\n\nfunction Dashboard(props){\n    const accessToken = useAuth(props.code)\n    const [search, setSearch] = useState(\"\")\n    const [searchResults, setSearchResults] = useState([])\n    const [playingTrack, setPlayingTrack] = useState()\n    const [lyrics, setLyrics] = useState(\"\")\n\n\n    function chooseTrack(track){\n        setPlayingTrack(track)\n        setSearch(\"\")\n        setLyrics(\"\")\n    }\n    // console.log(accessToken)\n    useEffect(()=>{\n       if(!accessToken) return\n       spotifyApi.setAccessToken(accessToken);\n    }, [accessToken])\n    \n    useEffect(()=>{\n       if(!search) return setSearchResults([])\n       if(!accessToken) return\n       let cancel = false\n       spotifyApi.searchTracks(search).then(res=>{\n           if (cancel) return\n           setSearchResults(\n            res.body.tracks.items.map(track=>{\n                    const smallestAlbumImage = track.album.images.reduce(\n                        (smallest, image)=>{\n                            if(image.height < smallest.height) return image\n                            return smallest\n                        },\n                        track.album.images[0]\n                    )\n                    return{\n                        artist: track.artists[0].name,\n                        title: track.name,\n                        uri: track.uri,\n                        albumUrl: smallestAlbumImage.url\n                    }\n            })\n           )\n       })\n       return ()=> cancel=true\n    }, [search, accessToken])\n\n    useEffect(()=>{\n        if(!playingTrack) return\n        \n        axios.get(\"https://myspotify-server.herokuapp.com/lyrics\",{\n            params:{\n                track: playingTrack.title,\n                artist: playingTrack.artist\n            }\n        }).then(res=>{\n            setLyrics(res.data.lyrics)\n        })\n    },[playingTrack])\n\n    return(\n        <Container className=\"d-flex flex-column py-2\" style={{height: \"100vh\"}}>\n            <Form.Control\n                type='search'\n                placeholder=\"Search Songs/Artists\"\n                value={search}\n                onChange={e=>{setSearch(e.target.value)}}\n            />\n            <div className=\"flex-grow-1 my-2\" style={{overflowY:\"auto\"}}>\n                {searchResults.map(track=>(\n                    <TrackSearchResult track={track} key={track.uri} chooseTrack={chooseTrack}/>\n                ))}\n                {searchResults.length === 0 && (\n                    <div className=\"text-center\" style={{whiteSpace: \"pre\"}}>\n                        {lyrics}\n                    </div>\n                )}  \n\n\n            </div>\n            <div><Player accessToken={accessToken} trackUri={playingTrack?.uri} /></div>\n        </Container>\n    );\n}\n\nexport default Dashboard;","import 'bootstrap/dist/css/bootstrap.min.css';\nimport Login from \"./Login.js\";\nimport Dashboard from \"./Dashboard.js\";\n\nconst code = new URLSearchParams(window.location.search).get(\"code\");\n\nfunction App() {\n  return code ? <Dashboard code={code}/> : <Login/>;\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import './index.css';\nimport App from './App';\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}